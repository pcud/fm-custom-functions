/*
 *  CUSTOM FUNCTION
 *    ErrorArrayGetMinimal ( errorArray )
 *
 *  DESCRIPTION
 *    Gets an small array of passed error information or the current error information but doesn't include the system state information
 *
 *  PARAMS
 *    errorArray: Optional: The array of error information generated by ErrorAppend
 *
 *  RETURNS
 *    Object
 *
 *  DEPENDENCIES
 *    None
 *
 *  CHANGELOG
 *    2023-05-09: Paul McCudden: Created
 *    2023-07-06: Paul McCudden: Added errorArray parameter
 *    2024-12-12: Paul McCudden: Updated name to distinguish between other error methods
 *
*/

While (
    [
        ~oldErrorData = If ( IsEmpty ( errorArray ); $errorData );
        ~oldErrorData = If ( JSONGetElementType ( ~oldErrorData; "" ) <> JSONArray; "[]"; ~oldErrorData );
        ~newErrorData = "[]";
        ~count = ValueCount ( JSONListKeys ( ~oldErrorData; "" ) );
        ~i = 0
    ];

    ~i < ~count;

    [
        ~i = ~i + 1;
        ~thisError = JSONGetElement ( ~oldErrorData; "[" & ~i - 1 & "]" );
        ~newErrorData = JSONSetElement ( ~newErrorData
            ;["[" & ~i - 1 & "]"; JSONDeleteElement ( ~thisError; "systemState" ); JSONObject]
        )
    ];

    ~newErrorData

)